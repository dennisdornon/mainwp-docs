\doxysection{phpseclib3\textbackslash{}Crypt Namespace Reference}
\hypertarget{namespacephpseclib3_1_1_crypt}{}\label{namespacephpseclib3_1_1_crypt}\index{phpseclib3\textbackslash{}Crypt@{phpseclib3\textbackslash{}Crypt}}
\doxysubsubsection*{Namespaces}
\begin{DoxyCompactItemize}
\item 
namespace \mbox{\hyperlink{namespacephpseclib3_1_1_crypt_1_1_common}{Common}}
\item 
namespace \mbox{\hyperlink{namespacephpseclib3_1_1_crypt_1_1_d_h}{DH}}
\item 
namespace \mbox{\hyperlink{namespacephpseclib3_1_1_crypt_1_1_d_s_a}{DSA}}
\item 
namespace \mbox{\hyperlink{namespacephpseclib3_1_1_crypt_1_1_e_c}{EC}}
\item 
namespace \mbox{\hyperlink{namespacephpseclib3_1_1_crypt_1_1_r_s_a}{RSA}}
\end{DoxyCompactItemize}
\doxysubsubsection*{Classes}
\begin{DoxyCompactItemize}
\item 
class \mbox{\hyperlink{classphpseclib3_1_1_crypt_1_1_a_e_s}{AES}}
\item 
class \mbox{\hyperlink{classphpseclib3_1_1_crypt_1_1_blowfish}{Blowfish}}
\item 
class \mbox{\hyperlink{classphpseclib3_1_1_crypt_1_1_cha_cha20}{Cha\+Cha20}}
\item 
class \mbox{\hyperlink{classphpseclib3_1_1_crypt_1_1_d_e_s}{DES}}
\item 
class \mbox{\hyperlink{classphpseclib3_1_1_crypt_1_1_d_h}{DH}}
\item 
class \mbox{\hyperlink{classphpseclib3_1_1_crypt_1_1_d_s_a}{DSA}}
\item 
class \mbox{\hyperlink{classphpseclib3_1_1_crypt_1_1_e_c}{EC}}
\item 
class \mbox{\hyperlink{classphpseclib3_1_1_crypt_1_1_hash}{Hash}}
\item 
class \mbox{\hyperlink{classphpseclib3_1_1_crypt_1_1_public_key_loader}{Public\+Key\+Loader}}
\item 
class \mbox{\hyperlink{classphpseclib3_1_1_crypt_1_1_random}{Random}}
\item 
class \mbox{\hyperlink{classphpseclib3_1_1_crypt_1_1_r_c2}{RC2}}
\item 
class \mbox{\hyperlink{classphpseclib3_1_1_crypt_1_1_r_c4}{RC4}}
\item 
class \mbox{\hyperlink{classphpseclib3_1_1_crypt_1_1_rijndael}{Rijndael}}
\item 
class \mbox{\hyperlink{classphpseclib3_1_1_crypt_1_1_r_s_a}{RSA}}
\item 
class \mbox{\hyperlink{classphpseclib3_1_1_crypt_1_1_salsa20}{Salsa20}}
\item 
class \mbox{\hyperlink{classphpseclib3_1_1_crypt_1_1_triple_d_e_s}{Triple\+DES}}
\item 
class \mbox{\hyperlink{classphpseclib3_1_1_crypt_1_1_twofish}{Twofish}}
\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
Pure-\/\+PHP implementation of AES.

Uses mcrypt, if available/possible, and an internal implementation, otherwise.

PHP version 5

NOTE\+: Since \doxylink{_a_e_s_8php}{AES.\+php} is (for compatibility and phpseclib-\/historical reasons) virtually just a wrapper to \doxylink{_rijndael_8php}{Rijndael.\+php} you may consider using \doxylink{_rijndael_8php}{Rijndael.\+php} instead of to save one include\+\_\+once().

If {\ttfamily \doxylink{}{set\+Key\+Length()}} isn\textquotesingle{}t called, it\textquotesingle{}ll be calculated from {\ttfamily \doxylink{}{set\+Key()}}. ie. if the key is 128-\/bits, the key length will be 128-\/bits. If it\textquotesingle{}s 136-\/bits it\textquotesingle{}ll be null-\/padded to 192-\/bits and 192 bits will be the key length until {\ttfamily \doxylink{}{set\+Key()}} is called, again, at which point, it\textquotesingle{}ll be recalculated.

Since \textbackslash{}phpseclib3\textbackslash{}\+Crypt\textbackslash{}\+AES extends \textbackslash{}phpseclib3\textbackslash{}\+Crypt\textbackslash{}\+Rijndael, some functions are available to be called that, in the context of AES, don\textquotesingle{}t make a whole lot of sense. {\ttfamily \doxylink{}{set\+Block\+Length()}}, for instance. Calling that function, however possible, won\textquotesingle{}t do anything (AES has a fixed block length whereas Rijndael has a variable one).

Here\textquotesingle{}s a short example of how to use this library\+: {\ttfamily  \texorpdfstring{$<$}{<}?php include \textquotesingle{}\doxylink{autoload_8php}{vendor/autoload.\+php}\textquotesingle{};}

{\ttfamily  \$aes = new \textbackslash{}phpseclib3\textbackslash{}\+Crypt\textbackslash{}\+AES(\textquotesingle{}ctr\textquotesingle{});}

{\ttfamily  \$aes-\/\texorpdfstring{$>$}{>}set\+Key(\textquotesingle{}abcdefghijklmnop\textquotesingle{});}

{\ttfamily  \$size = 10 \texorpdfstring{$\ast$}{*} 1024; \$plaintext = \textquotesingle{}\textquotesingle{}; for (\$i = 0; \$i \texorpdfstring{$<$}{<} \$size; \$i++) \{ \$plaintext.= \textquotesingle{}a\textquotesingle{}; \}}

{\ttfamily  echo \$aes-\/\texorpdfstring{$>$}{>}decrypt(\$aes-\/\texorpdfstring{$>$}{>}encrypt(\$plaintext)); ?\texorpdfstring{$>$}{>} }

\begin{DoxyAuthor}{Author}
Jim Wigginton \href{mailto:terrafrost@php.net}{\texttt{ terrafrost@php.\+net}} 
\end{DoxyAuthor}
\begin{DoxyCopyright}{Copyright}
2008 Jim Wigginton @license \href{http://www.opensource.org/licenses/mit-license.html}{\texttt{ http\+://www.\+opensource.\+org/licenses/mit-\/license.\+html}} MIT License \doxylink{}{Pure-\/\+PHP implementation of Blowfish. Uses mcrypt, if available, and an internal implementation, otherwise. PHP version 5 Useful resources are as follows\+:  \href{http://en.wikipedia.org/wiki/Blowfish_(cipher)}{\texttt{ http\+://en.\+wikipedia.\+org/wiki/\+Blowfish\+\_\+(cipher)}} Wikipedia description of Blowfish\}  autotoc\+\_\+md28 An overview of bcrypt vs Blowfish Open\+SSH private keys use a customized version of bcrypt. Specifically, instead of encrypting Orphean\+Beholder\+Scry\+Doubt 64 times Open\+SSH\textquotesingle{}s bcrypt variant encrypts Oxychromatic\+Blowfish\+Swat\+Dynamite 64 times. so we can\textquotesingle{}t use crypt(). bcrypt is basically Blowfish but instead of performing the key expansion once it performs the expansion 129 times for each round, with the first key expansion interleaving the salt and password. This renders Open\+SSL unusable and forces us to use a pure-\/\+PHP implementation of blowfish.  autotoc\+\_\+md29 phpseclib\textquotesingle{}s four different \+\_\+encrypt\+Block() implementations When using Blowfish as an encryption algorithm, \+\_\+encrypt\+Block() is called 9 + 512 + (the number of blocks in the plaintext) times. Each of the first 9 calls to \+\_\+encrypt\+Block() modify the P-\/array. Each of the next 512 calls modify the S-\/boxes. The remaining \+\_\+encrypt\+Block() calls operate on the plaintext to produce the ciphertext. In the pure-\/\+PHP implementation of Blowfish these remaining \+\_\+encrypt\+Block() calls are highly optimized through the use of eval(). Among other things, P-\/array lookups are eliminated by hard-\/coding the key-\/dependent P-\/array values, and thus we have explained 2 of the 4 different \+\_\+encrypt\+Block() implementations. With bcrypt things are a bit different. \+\_\+encrypt\+Block() is called 1,079,296 times, assuming 16 rounds (which is what Open\+SSH\textquotesingle{}s bcrypt defaults to). The eval()-\/optimized \+\_\+encrypt\+Block() isn\textquotesingle{}t as beneficial because the P-\/array values are not constant. Well, they are constant, but only for, at most, 777 \+\_\+encrypt\+Block() calls, which is equivalent to \texorpdfstring{$\sim$}{\string~}6\+KB of data. The average length of back to back \+\_\+encrypt\+Block() calls with a fixed P-\/array is 514.\+12, which is \texorpdfstring{$\sim$}{\string~}4\+KB of data. Creating an eval()-\/optimized \+\_\+encrypt\+Block() has an upfront cost, which is CPU dependent and is probably not going to be worth it for just \texorpdfstring{$\sim$}{\string~}4\+KB of data. Conseqeuently, bcrypt does not benefit from the eval()-\/optimized \+\_\+encrypt\+Block(). The regular \+\_\+encrypt\+Block() does unpack() and pack() on every call, as well, and that can begin to add up after one million function calls. In theory, one might think that it might be beneficial to rewrite all block ciphers so that, instead of passing strings to \+\_\+encrypt\+Block(), you convert the string to an array of integers and then pass successive subarrays of that array to \+\_\+encrypt\+Block. This, however, kills PHP\textquotesingle{}s memory use. Like let\textquotesingle{}s say you have a 1MB long string. After doing \$in = str\+\_\+repeat(\textquotesingle{}a\textquotesingle{}, 1024 \texorpdfstring{$\ast$}{*} 1024); PHP\textquotesingle{}s memory utilization jumps up by \texorpdfstring{$\sim$}{\string~}1\+MB. After doing \$blocks = str\+\_\+split(\$in, 4); it jumps up by an additional \texorpdfstring{$\sim$}{\string~}16\+MB. After \$blocks = array\+\_\+map(fn(\$x) =\texorpdfstring{$>$}{>} unpack(\textquotesingle{}N\texorpdfstring{$\ast$}{*}\textquotesingle{}, \$x), \$blocks); it jumps up by an additional \texorpdfstring{$\sim$}{\string~}90\+MB, yielding a 106x increase in memory usage. Consequently, it bcrypt calls a different \+\_\+encrypt\+Block() then the regular Blowfish does. That said, the Blowfish \+\_\+encrypt\+Block() is basically just a thin wrapper around the bcrypt \+\_\+encrypt\+Block(), so there\textquotesingle{}s that. This explains 3 of the 4 \+\_\+encrypt\+Block() implementations. the last \+\_\+encrypt\+Block() implementation can best be understood by doing Ctrl + F and searching for where self\+::\$use\+\_\+reg\+\_\+intval is defined.  autotoc\+\_\+md30 phpseclib\textquotesingle{}s three different \+\_\+setup\+Key() implementations Every bcrypt round is the equivalent of encrypting 512KB of data. Since Open\+SSH uses 16 rounds by default that\textquotesingle{}s \texorpdfstring{$\sim$}{\string~}8\+MB of data that\textquotesingle{}s essentially being encrypted whenever you use bcrypt. That\textquotesingle{}s a lot of data, however, bcrypt operates within tighter constraints than regular Blowfish, so we can use that to our advantage. In particular, whereas Blowfish supports variable length keys, in bcrypt, the initial "{}key"{} is the sha512 hash of the password. sha512 hashes are 512 bits or 64 bytes long and thus the bcrypt keys are of a fixed length whereas Blowfish keys are not of a fixed length. bcrypt actually has two different key expansion steps. The first one (expandstate) is constantly XOR\textquotesingle{}ing every \+\_\+encrypt\+Block() parameter against the salt prior \+\_\+encrypt\+Block()\textquotesingle{}s being called. The second one (expand0state) is more similar to Blowfish\textquotesingle{}s \+\_\+setup\+Key() but it can still use the fixed length key optimization discussed above and can do away with the pack() / unpack() calls. I suppose \+\_\+setup\+Key() could be made to be a thin wrapper around expandstate() but idk it\textquotesingle{}s just a lot of work for very marginal benefits as \+\_\+setup\+Key() is only called once for regular Blowfish vs the 128 times it\textquotesingle{}s called --per round-- with bcrypt.  autotoc\+\_\+md31 blowfish + bcrypt in the same class Altho there\textquotesingle{}s a lot of Blowfish code that bcrypt doesn\textquotesingle{}t re-\/use, bcrypt does re-\/use the initial S-\/boxes, the initial P-\/array and the int-\/only \+\_\+encrypt\+Block() implementation.  autotoc\+\_\+md32 Credit phpseclib\textquotesingle{}s bcrypt implementation is based losely off of Open\+SSH\textquotesingle{}s implementation\+: \href{https://github.com/openssh/openssh-portable/blob/master/openbsd-compat/bcrypt_pbkdf.c}{\texttt{ https\+://github.\+com/openssh/openssh-\/portable/blob/master/openbsd-\/compat/bcrypt\+\_\+pbkdf.\+c}} Here\textquotesingle{}s a short example of how to use this library\+: {\ttfamily  \texorpdfstring{$<$}{<}?php include \textquotesingle{}vendor/autoload.\+php\textquotesingle{};  \$blowfish = new (\textquotesingle{}ctr\textquotesingle{});  \$blowfish-\/\texorpdfstring{$>$}{>}set\+Key(\textquotesingle{}12345678901234567890123456789012\textquotesingle{});  \$plaintext = str\+\_\+repeat(\textquotesingle{}a\textquotesingle{}, 1024);  echo \$blowfish-\/\texorpdfstring{$>$}{>}decrypt(\$blowfish-\/\texorpdfstring{$>$}{>}encrypt(\$plaintext)); ?\texorpdfstring{$>$}{>} }  Jim Wigginton \href{mailto:terrafrost@php.net}{\texttt{ terrafrost@php.\+net}}  Hans-\/\+Juergen Petrich \href{mailto:petrich@tronic-media.com}{\texttt{ petrich@tronic-\/media.\+com}}  2007 Jim Wigginton  \href{http://www.opensource.org/licenses/mit-license.html}{\texttt{ http\+://www.\+opensource.\+org/licenses/mit-\/license.\+html}} MIT License  \href{http://phpseclib.sourceforge.net}{\texttt{ http\+://phpseclib.\+sourceforge.\+net}} Pure-\/\+PHP implementation of Cha\+Cha20. PHP version 5  Jim Wigginton \href{mailto:terrafrost@php.net}{\texttt{ terrafrost@php.\+net}}  2019 Jim Wigginton  \href{http://www.opensource.org/licenses/mit-license.html}{\texttt{ http\+://www.\+opensource.\+org/licenses/mit-\/license.\+html}} MIT License  \href{http://phpseclib.sourceforge.net}{\texttt{ http\+://phpseclib.\+sourceforge.\+net}} Pure-\/\+PHP implementation of DES. Uses mcrypt, if available, and an internal implementation, otherwise. PHP version 5 Useful resources are as follows\+:  \href{http://en.wikipedia.org/wiki/DES_supplementary_material}{\texttt{ http\+://en.\+wikipedia.\+org/wiki/\+DES\+\_\+supplementary\+\_\+material}} Wikipedia\+: DES supplementary material\} \href{http://www.itl.nist.gov/fipspubs/fip46-2.htm}{\texttt{ http\+://www.\+itl.\+nist.\+gov/fipspubs/fip46-\/2.\+htm}} FIPS 46-\/2 -\/ (DES), Data Encryption Standard\} \href{http://www.cs.eku.edu/faculty/styer/460/Encrypt/JS-DES.html}{\texttt{ http\+://www.\+cs.\+eku.\+edu/faculty/styer/460/\+Encrypt/\+JS-\/\+DES.\+html}} Java\+Script DES Example\} Here\textquotesingle{}s a short example of how to use this library\+: {\ttfamily  \texorpdfstring{$<$}{<}?php include \textquotesingle{}vendor/autoload.\+php\textquotesingle{};  \$des = new (\textquotesingle{}ctr\textquotesingle{});  \$des-\/\texorpdfstring{$>$}{>}set\+Key(\textquotesingle{}abcdefgh\textquotesingle{});  \$size = 10 \texorpdfstring{$\ast$}{*} 1024; \$plaintext = \textquotesingle{}\textquotesingle{}; for (\$i = 0; \$i \texorpdfstring{$<$}{<} \$size; \$i++) \{ \$plaintext.= \textquotesingle{}a\textquotesingle{}; \}  echo \$des-\/\texorpdfstring{$>$}{>}decrypt(\$des-\/\texorpdfstring{$>$}{>}encrypt(\$plaintext)); ?\texorpdfstring{$>$}{>} }  Jim Wigginton \href{mailto:terrafrost@php.net}{\texttt{ terrafrost@php.\+net}}  2007 Jim Wigginton  \href{http://www.opensource.org/licenses/mit-license.html}{\texttt{ http\+://www.\+opensource.\+org/licenses/mit-\/license.\+html}} MIT License  \href{http://phpseclib.sourceforge.net}{\texttt{ http\+://phpseclib.\+sourceforge.\+net}} Pure-\/\+PHP (EC)DH implementation PHP version 5 Here\textquotesingle{}s an example of how to compute a shared secret with this library\+: {\ttfamily  \texorpdfstring{$<$}{<}?php include \textquotesingle{}vendor/autoload.\+php\textquotesingle{}; \$our\+Private = \+::create\+Key(); \$secret = DH\+::compute\+Secret(\$our\+Private, \$their\+Public); ?\texorpdfstring{$>$}{>} }  Jim Wigginton \href{mailto:terrafrost@php.net}{\texttt{ terrafrost@php.\+net}}  2016 Jim Wigginton  \href{http://www.opensource.org/licenses/mit-license.html}{\texttt{ http\+://www.\+opensource.\+org/licenses/mit-\/license.\+html}} MIT License  \href{http://phpseclib.sourceforge.net}{\texttt{ http\+://phpseclib.\+sourceforge.\+net}} Pure-\/\+PHP FIPS 186-\/4 compliant implementation of DSA. PHP version 5 Here\textquotesingle{}s an example of how to create signatures and verify signatures with this library\+: {\ttfamily  \texorpdfstring{$<$}{<}?php include \textquotesingle{}vendor/autoload.\+php\textquotesingle{}; \$private = \+::create\+Key(); \$public = \$private-\/\texorpdfstring{$>$}{>}get\+Public\+Key(); \$plaintext = \textquotesingle{}terrafrost\textquotesingle{}; \$signature = \$private-\/\texorpdfstring{$>$}{>}sign(\$plaintext); echo \$public-\/\texorpdfstring{$>$}{>}verify(\$plaintext, \$signature) ? \textquotesingle{}verified\textquotesingle{} \+: \textquotesingle{}unverified\textquotesingle{}; ?\texorpdfstring{$>$}{>} }  Jim Wigginton \href{mailto:terrafrost@php.net}{\texttt{ terrafrost@php.\+net}}  2016 Jim Wigginton  \href{http://www.opensource.org/licenses/mit-license.html}{\texttt{ http\+://www.\+opensource.\+org/licenses/mit-\/license.\+html}} MIT License  \href{http://phpseclib.sourceforge.net}{\texttt{ http\+://phpseclib.\+sourceforge.\+net}} Pure-\/\+PHP implementation of EC. PHP version 5 Here\textquotesingle{}s an example of how to create signatures and verify signatures with this library\+: {\ttfamily  \texorpdfstring{$<$}{<}?php include \textquotesingle{}vendor/autoload.\+php\textquotesingle{}; \$private = \+::create\+Key(\textquotesingle{}secp256k1\textquotesingle{}); \$public = \$private-\/\texorpdfstring{$>$}{>}get\+Public\+Key(); \$plaintext = \textquotesingle{}terrafrost\textquotesingle{}; \$signature = \$private-\/\texorpdfstring{$>$}{>}sign(\$plaintext); echo \$public-\/\texorpdfstring{$>$}{>}verify(\$plaintext, \$signature) ? \textquotesingle{}verified\textquotesingle{} \+: \textquotesingle{}unverified\textquotesingle{}; ?\texorpdfstring{$>$}{>} }  Jim Wigginton \href{mailto:terrafrost@php.net}{\texttt{ terrafrost@php.\+net}}  2016 Jim Wigginton  \href{http://www.opensource.org/licenses/mit-license.html}{\texttt{ http\+://www.\+opensource.\+org/licenses/mit-\/license.\+html}} MIT License  \href{http://phpseclib.sourceforge.net}{\texttt{ http\+://phpseclib.\+sourceforge.\+net}} Wrapper around hash() and hash\+\_\+hmac() functions supporting truncated hashes such as sha256-\/96. Any hash algorithm returned by hash\+\_\+algos() (and truncated versions thereof) are supported. If  self\+::set\+Key() set\+Key()\} is called,  self\+::hash() hash()\} will return the HMAC as opposed to the hash. Here\textquotesingle{}s a short example of how to use this library\+: {\ttfamily  \texorpdfstring{$<$}{<}?php include \textquotesingle{}vendor/autoload.\+php\textquotesingle{};  \$hash = new (\textquotesingle{}sha512\textquotesingle{});  \$hash-\/\texorpdfstring{$>$}{>}set\+Key(\textquotesingle{}abcdefg\textquotesingle{});  echo base64\+\_\+encode(\$hash-\/\texorpdfstring{$>$}{>}hash(\textquotesingle{}abcdefg\textquotesingle{})); ?\texorpdfstring{$>$}{>} }  Jim Wigginton \href{mailto:terrafrost@php.net}{\texttt{ terrafrost@php.\+net}}  2015 Jim Wigginton  Andreas Fischer \href{mailto:bantu@phpbb.com}{\texttt{ bantu@phpbb.\+com}}  2015 Andreas Fischer  \href{http://www.opensource.org/licenses/mit-license.html}{\texttt{ http\+://www.\+opensource.\+org/licenses/mit-\/license.\+html}} MIT License  \href{http://phpseclib.sourceforge.net}{\texttt{ http\+://phpseclib.\+sourceforge.\+net}} Public\+Key\+Loader Returns a Public\+Key or Private\+Key object.  Jim Wigginton \href{mailto:terrafrost@php.net}{\texttt{ terrafrost@php.\+net}}  2009 Jim Wigginton  \href{http://www.opensource.org/licenses/mit-license.html}{\texttt{ http\+://www.\+opensource.\+org/licenses/mit-\/license.\+html}} MIT License  \href{http://phpseclib.sourceforge.net}{\texttt{ http\+://phpseclib.\+sourceforge.\+net}} Random Number Generator PHP version 5 Here\textquotesingle{}s a short example of how to use this library\+: {\ttfamily  \texorpdfstring{$<$}{<}?php include \textquotesingle{}vendor/autoload.\+php\textquotesingle{};  echo bin2hex(\+::string(8)); ?\texorpdfstring{$>$}{>} }  Jim Wigginton \href{mailto:terrafrost@php.net}{\texttt{ terrafrost@php.\+net}}  2007 Jim Wigginton  \href{http://www.opensource.org/licenses/mit-license.html}{\texttt{ http\+://www.\+opensource.\+org/licenses/mit-\/license.\+html}} MIT License  \href{http://phpseclib.sourceforge.net}{\texttt{ http\+://phpseclib.\+sourceforge.\+net}} Pure-\/\+PHP implementation of RC2. Uses mcrypt, if available, and an internal implementation, otherwise. PHP version 5 Useful resources are as follows\+:  \href{http://tools.ietf.org/html/rfc2268}{\texttt{ http\+://tools.\+ietf.\+org/html/rfc2268}}\} Here\textquotesingle{}s a short example of how to use this library\+: {\ttfamily  \texorpdfstring{$<$}{<}?php include \textquotesingle{}vendor/autoload.\+php\textquotesingle{};  \$rc2 = new (\textquotesingle{}ctr\textquotesingle{});  \$rc2-\/\texorpdfstring{$>$}{>}set\+Key(\textquotesingle{}abcdefgh\textquotesingle{});  \$plaintext = str\+\_\+repeat(\textquotesingle{}a\textquotesingle{}, 1024);  echo \$rc2-\/\texorpdfstring{$>$}{>}decrypt(\$rc2-\/\texorpdfstring{$>$}{>}encrypt(\$plaintext)); ?\texorpdfstring{$>$}{>} }  Patrick Monnerat \href{mailto:pm@datasphere.ch}{\texttt{ pm@datasphere.\+ch}}  \href{http://www.opensource.org/licenses/mit-license.html}{\texttt{ http\+://www.\+opensource.\+org/licenses/mit-\/license.\+html}} MIT License  \href{http://phpseclib.sourceforge.net}{\texttt{ http\+://phpseclib.\+sourceforge.\+net}} Pure-\/\+PHP implementation of RC4. Uses mcrypt, if available, and an internal implementation, otherwise. PHP version 5 Useful resources are as follows\+:  \href{http://www.mozilla.org/projects/security/pki/nss/draft-kaukonen-cipher-arcfour-03.txt}{\texttt{ http\+://www.\+mozilla.\+org/projects/security/pki/nss/draft-\/kaukonen-\/cipher-\/arcfour-\/03.\+txt}} ARCFOUR Algorithm\} \href{http://en.wikipedia.org/wiki/RC4}{\texttt{ http\+://en.\+wikipedia.\+org/wiki/\+RC4}} -\/ Wikipedia\+: RC4\} RC4 is also known as ARCFOUR or ARC4. The reason is elaborated upon at Wikipedia. This class is named RC4 and not ARCFOUR or ARC4 because RC4 is how it is referred to in the SSH1 specification. Here\textquotesingle{}s a short example of how to use this library\+: {\ttfamily  \texorpdfstring{$<$}{<}?php include \textquotesingle{}vendor/autoload.\+php\textquotesingle{};  \$rc4 = new ();  \$rc4-\/\texorpdfstring{$>$}{>}set\+Key(\textquotesingle{}abcdefgh\textquotesingle{});  \$size = 10 \texorpdfstring{$\ast$}{*} 1024; \$plaintext = \textquotesingle{}\textquotesingle{}; for (\$i = 0; \$i \texorpdfstring{$<$}{<} \$size; \$i++) \{ \$plaintext.= \textquotesingle{}a\textquotesingle{}; \}  echo \$rc4-\/\texorpdfstring{$>$}{>}decrypt(\$rc4-\/\texorpdfstring{$>$}{>}encrypt(\$plaintext)); ?\texorpdfstring{$>$}{>} }  Jim Wigginton \href{mailto:terrafrost@php.net}{\texttt{ terrafrost@php.\+net}}  2007 Jim Wigginton  \href{http://www.opensource.org/licenses/mit-license.html}{\texttt{ http\+://www.\+opensource.\+org/licenses/mit-\/license.\+html}} MIT License  \href{http://phpseclib.sourceforge.net}{\texttt{ http\+://phpseclib.\+sourceforge.\+net}} Pure-\/\+PHP implementation of Rijndael. Uses mcrypt, if available/possible, and an internal implementation, otherwise. PHP version 5 If  self\+::set\+Block\+Length() set\+Block\+Length()\} isn\textquotesingle{}t called, it\textquotesingle{}ll be assumed to be 128 bits. If  self\+::set\+Key\+Length() set\+Key\+Length()\} isn\textquotesingle{}t called, it\textquotesingle{}ll be calculated from  self\+::set\+Key() set\+Key()\}. ie. if the key is 128-\/bits, the key length will be 128-\/bits. If it\textquotesingle{}s 136-\/bits it\textquotesingle{}ll be null-\/padded to 192-\/bits and 192 bits will be the key length until  self\+::set\+Key() set\+Key()\} is called, again, at which point, it\textquotesingle{}ll be recalculated. Not all Rijndael implementations may support 160-\/bits or 224-\/bits as the block length / key length. mcrypt, for example, does not. AES, itself, only supports block lengths of 128 and key lengths of 128, 192, and 256.  \href{http://csrc.nist.gov/archive/aes/rijndael/Rijndael-ammended.pdf\#page=10}{\texttt{ http\+://csrc.\+nist.\+gov/archive/aes/rijndael/\+Rijndael-\/ammended.\+pdf\#page=10}} Rijndael-\/ammended.\+pdf\#page=10\} defines the algorithm for block lengths of 192 and 256 but not for block lengths / key lengths of 160 and 224. Indeed, 160 and 224 are first defined as valid key / block lengths in  \href{http://csrc.nist.gov/archive/aes/rijndael/Rijndael-ammended.pdf\#page=44}{\texttt{ http\+://csrc.\+nist.\+gov/archive/aes/rijndael/\+Rijndael-\/ammended.\+pdf\#page=44}} Rijndael-\/ammended.\+pdf\#page=44\}\+: Extensions\+: Other block and Cipher Key lengths. Note\+: Use of 160/224-\/bit Keys must be explicitly set by set\+Key\+Length(160) respectively set\+Key\+Length(224). \{ Pure-\/\+PHP PKCS\#1 (v2.\+1) compliant implementation of RSA. PHP version 5 Here\textquotesingle{}s an example of how to encrypt and decrypt text with this library\+: {\ttfamily  \texorpdfstring{$<$}{<}?php include \textquotesingle{}vendor/autoload.\+php\textquotesingle{}; \$private = \+::create\+Key(); \$public = \$private-\/\texorpdfstring{$>$}{>}get\+Public\+Key(); \$plaintext = \textquotesingle{}terrafrost\textquotesingle{}; \$ciphertext = \$public-\/\texorpdfstring{$>$}{>}encrypt(\$plaintext); echo \$private-\/\texorpdfstring{$>$}{>}decrypt(\$ciphertext); ?\texorpdfstring{$>$}{>} } Here\textquotesingle{}s an example of how to create signatures and verify signatures with this library\+: {\ttfamily  \texorpdfstring{$<$}{<}?php include \textquotesingle{}vendor/autoload.\+php\textquotesingle{}; \$private = \+::create\+Key(); \$public = \$private-\/\texorpdfstring{$>$}{>}get\+Public\+Key(); \$plaintext = \textquotesingle{}terrafrost\textquotesingle{}; \$signature = \$private-\/\texorpdfstring{$>$}{>}sign(\$plaintext); echo \$public-\/\texorpdfstring{$>$}{>}verify(\$plaintext, \$signature) ? \textquotesingle{}verified\textquotesingle{} \+: \textquotesingle{}unverified\textquotesingle{}; ?\texorpdfstring{$>$}{>} } One thing to consider when using this\+: so phpseclib uses PSS mode by default. Technically, id-\/\+RSASSA-\/\+PSS has a different key format than rsa\+Encryption. So should phpseclib save to the id-\/\+RSASSA-\/\+PSS format by default or the rsa\+Encryption format? For stand-\/alone keys I figure rsa\+Encryption is better because SSH doesn\textquotesingle{}t use PSS and idk how many SSH servers would be able to decode an id-\/\+RSASSA-\/\+PSS key. For X.\+509 certificates the id-\/\+RSASSA-\/\+PSS format is used by default (unless you change it up to use PKCS1 instead)  Jim Wigginton \href{mailto:terrafrost@php.net}{\texttt{ terrafrost@php.\+net}}  2009 Jim Wigginton  \href{http://www.opensource.org/licenses/mit-license.html}{\texttt{ http\+://www.\+opensource.\+org/licenses/mit-\/license.\+html}} MIT License  \href{http://phpseclib.sourceforge.net}{\texttt{ http\+://phpseclib.\+sourceforge.\+net}} Pure-\/\+PHP implementation of Salsa20. PHP version 5  Jim Wigginton \href{mailto:terrafrost@php.net}{\texttt{ terrafrost@php.\+net}}  2019 Jim Wigginton  \href{http://www.opensource.org/licenses/mit-license.html}{\texttt{ http\+://www.\+opensource.\+org/licenses/mit-\/license.\+html}} MIT License  \href{http://phpseclib.sourceforge.net}{\texttt{ http\+://phpseclib.\+sourceforge.\+net}} Pure-\/\+PHP implementation of Triple DES. Uses mcrypt, if available, and an internal implementation, otherwise. Operates in the EDE3 mode (encrypt-\/decrypt-\/encrypt). PHP version 5 Here\textquotesingle{}s a short example of how to use this library\+: {\ttfamily  \texorpdfstring{$<$}{<}?php include \textquotesingle{}vendor/autoload.\+php\textquotesingle{};  \$des = new (\textquotesingle{}ctr\textquotesingle{});  \$des-\/\texorpdfstring{$>$}{>}set\+Key(\textquotesingle{}abcdefghijklmnopqrstuvwx\textquotesingle{});  \$size = 10 \texorpdfstring{$\ast$}{*} 1024; \$plaintext = \textquotesingle{}\textquotesingle{}; for (\$i = 0; \$i \texorpdfstring{$<$}{<} \$size; \$i++) \{ \$plaintext.= \textquotesingle{}a\textquotesingle{}; \}  echo \$des-\/\texorpdfstring{$>$}{>}decrypt(\$des-\/\texorpdfstring{$>$}{>}encrypt(\$plaintext)); ?\texorpdfstring{$>$}{>} }  Jim Wigginton \href{mailto:terrafrost@php.net}{\texttt{ terrafrost@php.\+net}}  2007 Jim Wigginton  \href{http://www.opensource.org/licenses/mit-license.html}{\texttt{ http\+://www.\+opensource.\+org/licenses/mit-\/license.\+html}} MIT License  \href{http://phpseclib.sourceforge.net}{\texttt{ http\+://phpseclib.\+sourceforge.\+net}} Pure-\/\+PHP implementation of Twofish. Uses mcrypt, if available, and an internal implementation, otherwise. PHP version 5 Useful resources are as follows\+:  \href{http://en.wikipedia.org/wiki/Twofish}{\texttt{ http\+://en.\+wikipedia.\+org/wiki/\+Twofish}} Wikipedia description of Twofish\} Here\textquotesingle{}s a short example of how to use this library\+: {\ttfamily  \texorpdfstring{$<$}{<}?php include \textquotesingle{}vendor/autoload.\+php\textquotesingle{};  \$twofish = new (\textquotesingle{}ctr\textquotesingle{});  \$twofish-\/\texorpdfstring{$>$}{>}set\+Key(\textquotesingle{}12345678901234567890123456789012\textquotesingle{});  \$plaintext = str\+\_\+repeat(\textquotesingle{}a\textquotesingle{}, 1024);  echo \$twofish-\/\texorpdfstring{$>$}{>}decrypt(\$twofish-\/\texorpdfstring{$>$}{>}encrypt(\$plaintext)); ?\texorpdfstring{$>$}{>} }  Jim Wigginton \href{mailto:terrafrost@php.net}{\texttt{ terrafrost@php.\+net}}  Hans-\/\+Juergen Petrich \href{mailto:petrich@tronic-media.com}{\texttt{ petrich@tronic-\/media.\+com}}  2007 Jim Wigginton  \href{http://www.opensource.org/licenses/mit-license.html}{\texttt{ http\+://www.\+opensource.\+org/licenses/mit-\/license.\+html}} MIT License  \href{http://phpseclib.sourceforge.net}{\texttt{ http\+://phpseclib.\+sourceforge.\+net}} }
\end{DoxyCopyright}
