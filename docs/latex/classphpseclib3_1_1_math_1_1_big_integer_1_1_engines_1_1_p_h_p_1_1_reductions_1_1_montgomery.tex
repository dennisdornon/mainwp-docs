\doxysection{phpseclib3\textbackslash{}Math\textbackslash{}Big\+Integer\textbackslash{}Engines\textbackslash{}PHP\textbackslash{}Reductions\textbackslash{}Montgomery Class Reference}
\hypertarget{classphpseclib3_1_1_math_1_1_big_integer_1_1_engines_1_1_p_h_p_1_1_reductions_1_1_montgomery}{}\label{classphpseclib3_1_1_math_1_1_big_integer_1_1_engines_1_1_p_h_p_1_1_reductions_1_1_montgomery}\index{phpseclib3\textbackslash{}Math\textbackslash{}BigInteger\textbackslash{}Engines\textbackslash{}PHP\textbackslash{}Reductions\textbackslash{}Montgomery@{phpseclib3\textbackslash{}Math\textbackslash{}BigInteger\textbackslash{}Engines\textbackslash{}PHP\textbackslash{}Reductions\textbackslash{}Montgomery}}
Inheritance diagram for phpseclib3\textbackslash{}Math\textbackslash{}Big\+Integer\textbackslash{}Engines\textbackslash{}PHP\textbackslash{}Reductions\textbackslash{}Montgomery\+:\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[height=3.000000cm]{classphpseclib3_1_1_math_1_1_big_integer_1_1_engines_1_1_p_h_p_1_1_reductions_1_1_montgomery}
\end{center}
\end{figure}
\doxysubsubsection*{Static Protected Member Functions}
\begin{DoxyCompactItemize}
\item 
static \mbox{\hyperlink{classphpseclib3_1_1_math_1_1_big_integer_1_1_engines_1_1_p_h_p_1_1_reductions_1_1_montgomery_aa36d7dee6354da88400955284f99e3d0}{prepare\+Reduce}} (array \$x, array \$n, \$class)
\item 
static \mbox{\hyperlink{classphpseclib3_1_1_math_1_1_big_integer_1_1_engines_1_1_p_h_p_1_1_reductions_1_1_montgomery_a8cfb2b1fdeac0aef57b998d0389a0624}{reduce}} (array \$x, array \$n, \$class)
\item 
static \mbox{\hyperlink{classphpseclib3_1_1_math_1_1_big_integer_1_1_engines_1_1_p_h_p_1_1_reductions_1_1_montgomery_a03f00b9a03320302dd3f73ef70241ea3}{mod\+Inverse67108864}} (array \$x, \$class)
\end{DoxyCompactItemize}
\doxysubsection*{Static Protected Member Functions inherited from \mbox{\hyperlink{classphpseclib3_1_1_crypt_1_1_common_1_1_formats_1_1_keys_1_1_p_k_c_s1}{phpseclib3\textbackslash{}\+Crypt\textbackslash{}\+Common\textbackslash{}\+Formats\textbackslash{}\+Keys\textbackslash{}\+PKCS1}}}
\begin{DoxyCompactItemize}
\item 
static \mbox{\hyperlink{classphpseclib3_1_1_crypt_1_1_common_1_1_formats_1_1_keys_1_1_p_k_c_s1_ab28bf4bd1181be0864810afa202ccaa9}{load}} (\$key, \$password)
\item 
static \mbox{\hyperlink{classphpseclib3_1_1_crypt_1_1_common_1_1_formats_1_1_keys_1_1_p_k_c_s1_a2448383b8749822bff0fbcfc0de7b40e}{wrap\+Private\+Key}} (\$key, \$type, \$password, array \$options=\mbox{[}$\,$\mbox{]})
\item 
static \mbox{\hyperlink{classphpseclib3_1_1_crypt_1_1_common_1_1_formats_1_1_keys_1_1_p_k_c_s1_a48bb86d79195df655a8e5f0f3c224bb0}{wrap\+Public\+Key}} (\$key, \$type)
\end{DoxyCompactItemize}
\doxysubsubsection*{Additional Inherited Members}
\doxysubsection*{Static Public Member Functions inherited from \mbox{\hyperlink{classphpseclib3_1_1_crypt_1_1_common_1_1_formats_1_1_keys_1_1_p_k_c_s1}{phpseclib3\textbackslash{}\+Crypt\textbackslash{}\+Common\textbackslash{}\+Formats\textbackslash{}\+Keys\textbackslash{}\+PKCS1}}}
\begin{DoxyCompactItemize}
\item 
static \mbox{\hyperlink{classphpseclib3_1_1_crypt_1_1_common_1_1_formats_1_1_keys_1_1_p_k_c_s1_a726795d1429622b2684346f472961665}{set\+Encryption\+Algorithm}} (\$algo)
\end{DoxyCompactItemize}
\doxysubsection*{Static Public Member Functions inherited from \mbox{\hyperlink{classphpseclib3_1_1_crypt_1_1_common_1_1_formats_1_1_keys_1_1_p_k_c_s}{phpseclib3\textbackslash{}\+Crypt\textbackslash{}\+Common\textbackslash{}\+Formats\textbackslash{}\+Keys\textbackslash{}\+PKCS}}}
\begin{DoxyCompactItemize}
\item 
static \mbox{\hyperlink{classphpseclib3_1_1_crypt_1_1_common_1_1_formats_1_1_keys_1_1_p_k_c_s_a7c8c35c656415fbd992b36fe606d558b}{require\+PEM}} ()
\item 
static \mbox{\hyperlink{classphpseclib3_1_1_crypt_1_1_common_1_1_formats_1_1_keys_1_1_p_k_c_s_a317ce0256e4149a4b59227f8a1bff56d}{require\+DER}} ()
\item 
static \mbox{\hyperlink{classphpseclib3_1_1_crypt_1_1_common_1_1_formats_1_1_keys_1_1_p_k_c_s_ac50026ccce1861e0d00c6967376bc3bd}{require\+Any}} ()
\end{DoxyCompactItemize}
\doxysubsection*{Public Attributes inherited from \mbox{\hyperlink{classphpseclib3_1_1_crypt_1_1_common_1_1_formats_1_1_keys_1_1_p_k_c_s}{phpseclib3\textbackslash{}\+Crypt\textbackslash{}\+Common\textbackslash{}\+Formats\textbackslash{}\+Keys\textbackslash{}\+PKCS}}}
\begin{DoxyCompactItemize}
\item 
const \mbox{\hyperlink{classphpseclib3_1_1_crypt_1_1_common_1_1_formats_1_1_keys_1_1_p_k_c_s_a03ac502a91a77183dd215cde27329573}{MODE\+\_\+\+ANY}} = 0
\item 
const \mbox{\hyperlink{classphpseclib3_1_1_crypt_1_1_common_1_1_formats_1_1_keys_1_1_p_k_c_s_a179b9acb02ca8c3f359125ed29a02ce1}{MODE\+\_\+\+PEM}} = 1
\item 
const \mbox{\hyperlink{classphpseclib3_1_1_crypt_1_1_common_1_1_formats_1_1_keys_1_1_p_k_c_s_a86ce164946fac420cf9626cdfe574e3a}{MODE\+\_\+\+DER}} = 2
\end{DoxyCompactItemize}
\doxysubsection*{Static Protected Attributes inherited from \mbox{\hyperlink{classphpseclib3_1_1_crypt_1_1_common_1_1_formats_1_1_keys_1_1_p_k_c_s}{phpseclib3\textbackslash{}\+Crypt\textbackslash{}\+Common\textbackslash{}\+Formats\textbackslash{}\+Keys\textbackslash{}\+PKCS}}}
\begin{DoxyCompactItemize}
\item 
static \mbox{\hyperlink{classphpseclib3_1_1_crypt_1_1_common_1_1_formats_1_1_keys_1_1_p_k_c_s_a118301b88d734d517fe42c9e8f9184d3}{\$format}} = self\+::\+MODE\+\_\+\+ANY
\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
PHP Montgomery Modular Exponentiation Engine

\begin{DoxyAuthor}{Author}
Jim Wigginton \href{mailto:terrafrost@php.net}{\texttt{ terrafrost@php.\+net}} 
\end{DoxyAuthor}


\doxysubsection{Member Function Documentation}
\Hypertarget{classphpseclib3_1_1_math_1_1_big_integer_1_1_engines_1_1_p_h_p_1_1_reductions_1_1_montgomery_a03f00b9a03320302dd3f73ef70241ea3}\index{phpseclib3\textbackslash{}Math\textbackslash{}BigInteger\textbackslash{}Engines\textbackslash{}PHP\textbackslash{}Reductions\textbackslash{}Montgomery@{phpseclib3\textbackslash{}Math\textbackslash{}BigInteger\textbackslash{}Engines\textbackslash{}PHP\textbackslash{}Reductions\textbackslash{}Montgomery}!modInverse67108864@{modInverse67108864}}
\index{modInverse67108864@{modInverse67108864}!phpseclib3\textbackslash{}Math\textbackslash{}BigInteger\textbackslash{}Engines\textbackslash{}PHP\textbackslash{}Reductions\textbackslash{}Montgomery@{phpseclib3\textbackslash{}Math\textbackslash{}BigInteger\textbackslash{}Engines\textbackslash{}PHP\textbackslash{}Reductions\textbackslash{}Montgomery}}
\doxysubsubsection{\texorpdfstring{modInverse67108864()}{modInverse67108864()}}
{\footnotesize\ttfamily \label{classphpseclib3_1_1_math_1_1_big_integer_1_1_engines_1_1_p_h_p_1_1_reductions_1_1_montgomery_a03f00b9a03320302dd3f73ef70241ea3} 
static phpseclib3\textbackslash{}\+Math\textbackslash{}\+Big\+Integer\textbackslash{}\+Engines\textbackslash{}\+PHP\textbackslash{}\+Reductions\textbackslash{}\+Montgomery\+::mod\+Inverse67108864 (\begin{DoxyParamCaption}\item[{array}]{\$x}{, }\item[{}]{\$class}{}\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [static]}, {\ttfamily [protected]}}

Modular Inverse of a number mod 2\texorpdfstring{$\ast$}{*}\texorpdfstring{$\ast$}{*}26 (eg. 67108864)

Based off of the bnp\+Inv\+Digit function implemented and justified in the following URL\+:

{\ttfamily \doxylink{}{http\+://www-\/cs-\/students.\+stanford.\+edu/\texorpdfstring{$\sim$}{\string~}tjw/jsbn/jsbn.\+js}}

The following URL provides more info\+:

{\ttfamily \doxylink{}{http\+://groups.\+google.\+com/group/sci.\+crypt/msg/7a137205c1be7d85}}

As for why we do all the bitmasking... strange things can happen when converting from floats to ints. For instance, on some computers, var\+\_\+dump((int) -\/4294967297) yields int(-\/1) and on others, it yields int(-\/2147483648). To avoid problems stemming from this, we use bitmasks to guarantee that ints aren\textquotesingle{}t auto-\/converted to floats. The outermost bitmask is present because without it, there\textquotesingle{}s no guarantee that the "{}residue"{} returned would be the so-\/called "{}common residue"{}. We use fmod, in the last step, because the maximum possible \$x is 26 bits and the maximum \$result is 16 bits. Thus, we have to be able to handle up to 40 bits, which only 64-\/bit floating points will support.

Thanks to Pedro Gimeno Fortea for input!


\begin{DoxyParams}[1]{Parameters}
array & {\em \$x} & \\
\hline
string & {\em \$class} & \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
int 
\end{DoxyReturn}
\Hypertarget{classphpseclib3_1_1_math_1_1_big_integer_1_1_engines_1_1_p_h_p_1_1_reductions_1_1_montgomery_aa36d7dee6354da88400955284f99e3d0}\index{phpseclib3\textbackslash{}Math\textbackslash{}BigInteger\textbackslash{}Engines\textbackslash{}PHP\textbackslash{}Reductions\textbackslash{}Montgomery@{phpseclib3\textbackslash{}Math\textbackslash{}BigInteger\textbackslash{}Engines\textbackslash{}PHP\textbackslash{}Reductions\textbackslash{}Montgomery}!prepareReduce@{prepareReduce}}
\index{prepareReduce@{prepareReduce}!phpseclib3\textbackslash{}Math\textbackslash{}BigInteger\textbackslash{}Engines\textbackslash{}PHP\textbackslash{}Reductions\textbackslash{}Montgomery@{phpseclib3\textbackslash{}Math\textbackslash{}BigInteger\textbackslash{}Engines\textbackslash{}PHP\textbackslash{}Reductions\textbackslash{}Montgomery}}
\doxysubsubsection{\texorpdfstring{prepareReduce()}{prepareReduce()}}
{\footnotesize\ttfamily \label{classphpseclib3_1_1_math_1_1_big_integer_1_1_engines_1_1_p_h_p_1_1_reductions_1_1_montgomery_aa36d7dee6354da88400955284f99e3d0} 
static phpseclib3\textbackslash{}\+Math\textbackslash{}\+Big\+Integer\textbackslash{}\+Engines\textbackslash{}\+PHP\textbackslash{}\+Reductions\textbackslash{}\+Montgomery\+::prepare\+Reduce (\begin{DoxyParamCaption}\item[{array}]{\$x}{, }\item[{array}]{\$n}{, }\item[{}]{\$class}{}\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [static]}, {\ttfamily [protected]}}

Prepare a number for use in Montgomery Modular Reductions


\begin{DoxyParams}[1]{Parameters}
array & {\em \$x} & \\
\hline
array & {\em \$n} & \\
\hline
string & {\em \$class} & \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
array 
\end{DoxyReturn}
\Hypertarget{classphpseclib3_1_1_math_1_1_big_integer_1_1_engines_1_1_p_h_p_1_1_reductions_1_1_montgomery_a8cfb2b1fdeac0aef57b998d0389a0624}\index{phpseclib3\textbackslash{}Math\textbackslash{}BigInteger\textbackslash{}Engines\textbackslash{}PHP\textbackslash{}Reductions\textbackslash{}Montgomery@{phpseclib3\textbackslash{}Math\textbackslash{}BigInteger\textbackslash{}Engines\textbackslash{}PHP\textbackslash{}Reductions\textbackslash{}Montgomery}!reduce@{reduce}}
\index{reduce@{reduce}!phpseclib3\textbackslash{}Math\textbackslash{}BigInteger\textbackslash{}Engines\textbackslash{}PHP\textbackslash{}Reductions\textbackslash{}Montgomery@{phpseclib3\textbackslash{}Math\textbackslash{}BigInteger\textbackslash{}Engines\textbackslash{}PHP\textbackslash{}Reductions\textbackslash{}Montgomery}}
\doxysubsubsection{\texorpdfstring{reduce()}{reduce()}}
{\footnotesize\ttfamily \label{classphpseclib3_1_1_math_1_1_big_integer_1_1_engines_1_1_p_h_p_1_1_reductions_1_1_montgomery_a8cfb2b1fdeac0aef57b998d0389a0624} 
static phpseclib3\textbackslash{}\+Math\textbackslash{}\+Big\+Integer\textbackslash{}\+Engines\textbackslash{}\+PHP\textbackslash{}\+Reductions\textbackslash{}\+Montgomery\+::reduce (\begin{DoxyParamCaption}\item[{array}]{\$x}{, }\item[{array}]{\$n}{, }\item[{}]{\$class}{}\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [static]}, {\ttfamily [protected]}}

Montgomery Multiply

Interleaves the montgomery reduction and long multiplication algorithms together as described in {\ttfamily \doxylink{}{HAC 14.\+36}}


\begin{DoxyParams}[1]{Parameters}
array & {\em \$x} & \\
\hline
array & {\em \$n} & \\
\hline
string & {\em \$class} & \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
array 
\end{DoxyReturn}


The documentation for this class was generated from the following file\+:\begin{DoxyCompactItemize}
\item 
libs/phpseclib/vendor/phpseclib/phpseclib/phpseclib/\+Math/\+Big\+Integer/\+Engines/\+PHP/\+Reductions/\mbox{\hyperlink{_math_2_big_integer_2_engines_2_p_h_p_2_reductions_2_montgomery_8php}{Montgomery.\+php}}\end{DoxyCompactItemize}
